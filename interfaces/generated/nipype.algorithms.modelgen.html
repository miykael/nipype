
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Neuroimaging in Python - Pipelines and Interfaces &#8212; nipy pipeline and interfaces package</title>
    <link rel="stylesheet" href="../../_static/nipype.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
 
<meta name="keywords" content="nipype, neuroimaging, pipeline, workflow, parallel, python, neuroscience">
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-339450-7', 'nipy.org/nipype');
  ga('send', 'pageview');
</script>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'nipy/nipype'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

  </head><body>
<div class="header-wrapper">
    <div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
            <a href="../../index.html">
            <img src="../../_static/nipype-banner-bg.png" alt="NIPY logo"  border="0" />
        <div style="margin-top: 1em;
                border-top: 1px solid #AAA;
                border-bottom: 1px solid #AAA;
                border-radius: 5px;
                padding: 3px 1em;">
            <link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" />
<style type="text/css">
    a.navbar {
    color: ;
    letter-spacing: .05em;
    font-weight: bold;
        }
</style>

<a class="navbar" href="../../index.html">Home</a> ·
<a class="navbar" href="../../quickstart.html">Quickstart</a> ·
<a class="navbar" href="../../documentation.html">Documentation</a> ·
<a class="navbar" href="../../about.html">About</a> ·
<a class="navbar" href="http://nipy.org">Nipy</a>

        </div>
    </div>
</div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<style type="text/css">
    input.gsc-input {
        border-color: #BCCDF0;
    }
    input.gsc-search-button {
        border-color: #666666;
        background-color: #CECECE;
        padding: 0;
    }
    div.sphinxsidebar .tile {
        border: 1px solid #D1DDE2;
        border-radius: 10px;
        background-color: #E1E8EC;
        padding-left: 0.5em;
        margin: 1em 0;
    }
    div.sphinxsidebar input[type="text"] {
        width: 100%;
    }
    div.sphinxsidebar input[type="submit"] {
        width: 100%;
    }
</style>

<div class="sidebarblock">
    <script>
      (function() {
        var cx = '010960497803984932957:u8pmqf7fdoq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:search></gcse:search>
</div>

  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">algorithms.modelgen</a><ul>
<li><a class="reference internal" href="#specifymodel">SpecifyModel</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specifyspmmodel">SpecifySPMModel</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specifysparsemodel">SpecifySparseModel</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#id3">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#gen-info"><code class="docutils literal notranslate"><span class="pre">gen_info()</span></code></a></li>
<li><a class="reference internal" href="#orth"><code class="docutils literal notranslate"><span class="pre">orth()</span></code></a></li>
<li><a class="reference internal" href="#scale-timings"><code class="docutils literal notranslate"><span class="pre">scale_timings()</span></code></a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spm-hrf"><code class="docutils literal notranslate"><span class="pre">spm_hrf()</span></code></a></li>
</ul>
</li>
</ul>

<style type="text/css">
    div.sphinxsidebar .tile {
        border: 1px solid #D1DDE2;
        border-radius: 10px;
        background-color: #E1E8EC;
        padding-left: 0.5em;
        margin: 1em 0;
    }
</style>
<div class="sidebarblock">
    <h3>Versions</h3>

    <div class="tile">
        <table style="width: 100%;">
            <tr style="font-weight: bold;">
                <td align="left">Release</td><td align="right">Devel</td>
            </tr>
            <tr>
                <td align="left">1.1.3</td><td align="right">1.1.4-dev+g93c475b</td>
            </tr>
            <tr>
                <td align="left"><a href="../../users/install.html">Download</a></td>
                <td align="right"><a href="https://github.com/nipy/nipype">Github</a></td>
            </tr>
        </table>
    </div>
</div>


<script type="text/javascript">
    (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
</script>

<h3>Links</h3>

<ul>
    <li>Docs: <a href="http://nipy.org/nipype">Stable</a> · <a href="http://nipype.readthedocs.org/en/latest/">Dev</a></li>
    <li>Code: <a href="http://github.com/nipy/nipype">Github</a> · <a href="http://github.com/nipy/nipype/issues">Bugs-Requests</a></li>
    <li>Forum: <a href="https://neurostars.org/search?q=nipype">User</a> · <a href="https://mail.python.org/mailman/listinfo/neuroimaging">Developer</a></li>
    <li>Chat: <a href="https://gitter.im/nipy/nipype">Gitter</a> · <a href="https://brainhack.slack.com/messages/C1FR76RAL">Slack</a></li>
    <li><a href="about.html#funding">Funding</a> · <a href="http://nipy.org/software/license/index.html"><img src="https://img.shields.io/pypi/l/nipype.svg" alt="License"></a></li>
    <li><a href="https://travis-ci.org/nipy/nipype"><img src="https://travis-ci.org/nipy/nipype.png?branch=master" alt="travis"></a> · <a href='https://codecov.io/gh/nipy/nipype'><img src='https://codecov.io/gh/nipy/nipype/branch/master/graph/badge.svg' alt='Coverage Status' /></a></li>
    <a href='https://pypi.python.org/pypi/nipype/'><img src='https://img.shields.io/pypi/pyversions/nipype.svg' alt='Python Versions' /></a></li>
</ul>

 
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="algorithms-modelgen">
<h1>algorithms.modelgen<a class="headerlink" href="#algorithms-modelgen" title="Permalink to this headline">¶</a></h1>
<span class="target" id="nipype-algorithms-modelgen-specifymodel"></span><div class="section" id="specifymodel">
<span id="index-0"></span><h2>SpecifyModel<a class="headerlink" href="#specifymodel" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L239">Link to code</a></p>
<p>Makes a model specification compatible with spm/fsl designers.</p>
<p>The subject_info field should contain paradigm information in the form of
a Bunch or a list of Bunch. The Bunch should contain the following
information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Mandatory</span><span class="p">]</span>
<span class="o">-</span> <span class="n">conditions</span> <span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">names</span>
<span class="o">-</span> <span class="n">onsets</span> <span class="p">:</span> <span class="n">lists</span> <span class="n">of</span> <span class="n">onsets</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">each</span> <span class="n">condition</span>
<span class="o">-</span> <span class="n">durations</span> <span class="p">:</span> <span class="n">lists</span> <span class="n">of</span> <span class="n">durations</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">each</span> <span class="n">condition</span><span class="o">.</span> <span class="n">Should</span> <span class="n">be</span>
<span class="n">left</span> <span class="n">to</span> <span class="n">a</span> <span class="n">single</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">all</span> <span class="n">events</span> <span class="n">are</span> <span class="n">being</span> <span class="n">modelled</span> <span class="k">as</span> <span class="n">impulses</span><span class="o">.</span>

<span class="p">[</span><span class="n">Optional</span><span class="p">]</span>
<span class="o">-</span> <span class="n">regressor_names</span> <span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="nb">str</span>
    <span class="nb">list</span> <span class="n">of</span> <span class="n">names</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">each</span> <span class="n">column</span><span class="o">.</span> <span class="n">Should</span> <span class="n">be</span> <span class="kc">None</span> <span class="k">if</span>
    <span class="n">automatically</span> <span class="n">assigned</span><span class="o">.</span>
<span class="o">-</span> <span class="n">regressors</span> <span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">lists</span>
   <span class="n">values</span> <span class="k">for</span> <span class="n">each</span> <span class="n">regressor</span> <span class="o">-</span> <span class="n">must</span> <span class="n">correspond</span> <span class="n">to</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span>
   <span class="n">volumes</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">functional</span> <span class="n">run</span>
<span class="o">-</span> <span class="n">amplitudes</span> <span class="p">:</span> <span class="n">lists</span> <span class="n">of</span> <span class="n">amplitudes</span> <span class="k">for</span> <span class="n">each</span> <span class="n">event</span><span class="o">.</span> <span class="n">This</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ignored</span> <span class="n">by</span>
  <span class="n">SPM</span><span class="s1">&#39;s Level1Design.</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">two</span> <span class="p">(</span><span class="n">tmod</span><span class="p">,</span> <span class="n">pmod</span><span class="p">)</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ignored</span> <span class="n">by</span> <span class="nb">any</span> <span class="n">Level1Design</span> <span class="k">class</span>
<span class="nc">other</span> <span class="n">than</span> <span class="n">SPM</span><span class="p">:</span>

<span class="o">-</span> <span class="n">tmod</span> <span class="p">:</span> <span class="n">lists</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="n">temporally</span> <span class="n">modulated</span><span class="o">.</span> <span class="n">Should</span>
  <span class="n">default</span> <span class="n">to</span> <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">being</span> <span class="n">used</span><span class="o">.</span>
<span class="o">-</span> <span class="n">pmod</span> <span class="p">:</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">Bunch</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">conditions</span>
  <span class="o">-</span> <span class="n">name</span> <span class="p">:</span> <span class="n">name</span> <span class="n">of</span> <span class="n">parametric</span> <span class="n">modulator</span>
  <span class="o">-</span> <span class="n">param</span> <span class="p">:</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">modulator</span>
  <span class="o">-</span> <span class="n">poly</span> <span class="p">:</span> <span class="n">degree</span> <span class="n">of</span> <span class="n">modulation</span>
</pre></div>
</div>
<p>Alternatively, you can provide information through event files.</p>
<p>The event files have to be in 1, 2 or 3 column format with the columns
corresponding to Onsets, Durations and Amplitudes and they have to have the
name event_name.runXXX… e.g.: Words.run001.txt. The event_name part will
be used to create the condition names.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.algorithms</span> <span class="k">import</span> <span class="n">modelgen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.interfaces.base</span> <span class="k">import</span> <span class="n">Bunch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">modelgen</span><span class="o">.</span><span class="n">SpecifyModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">input_units</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">functional_runs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;functional2.nii&#39;</span><span class="p">,</span> <span class="s1">&#39;functional3.nii&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_repetition</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">high_pass_filter_cutoff</span> <span class="o">=</span> <span class="mf">128.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run2</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run3</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">subject_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">evs_run2</span><span class="p">,</span> <span class="n">evs_run3</span><span class="p">]</span>
</pre></div>
</div>
<p>Using pmod:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run2</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">,</span> <span class="s1">&#39;cond2&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pmod</span><span class="o">=</span><span class="p">[</span><span class="n">Bunch</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">],</span> <span class="n">poly</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">param</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run3</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">,</span> <span class="s1">&#39;cond2&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">160</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pmod</span><span class="o">=</span><span class="p">[</span><span class="n">Bunch</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;amp&#39;</span><span class="p">],</span> <span class="n">poly</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">param</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">subject_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">evs_run2</span><span class="p">,</span> <span class="n">evs_run3</span><span class="p">]</span>
</pre></div>
</div>
<p>Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Mandatory]
event_files: (a list of items which are a list of items which are an
         existing file name)
        List of event description files 1, 2 or 3 column format
        corresponding to onsets, durations and amplitudes
        mutually_exclusive: subject_info, event_files
functional_runs: (a list of items which are a list of items which are
         an existing file name or an existing file name)
        Data files for model. List of 4D files or list of list of 3D files
        per session
high_pass_filter_cutoff: (a float)
        High-pass filter cutoff in secs
input_units: (&#39;secs&#39; or &#39;scans&#39;)
        Units of event onsets and durations (secs or scans). Output units
        are always in secs
subject_info: (a list of items which are a Bunch or None)
        Bunch or List(Bunch) subject-specific condition information. see
        :ref:`SpecifyModel` or SpecifyModel.__doc__ for details
        mutually_exclusive: subject_info, event_files
time_repetition: (a float)
        Time between the start of one volume to the start of the next image
        volume.

[Optional]
outlier_files: (a list of items which are an existing file name)
        Files containing scan outlier indices that should be tossed
parameter_source: (&#39;SPM&#39; or &#39;FSL&#39; or &#39;AFNI&#39; or &#39;FSFAST&#39; or &#39;NIPY&#39;,
         nipype default value: SPM)
        Source of motion parameters
realignment_parameters: (a list of items which are an existing file
         name)
        Realignment parameters returned by motion correction algorithm
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session_info</span><span class="p">:</span> <span class="p">(</span><span class="nb">any</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">Session</span> <span class="n">info</span> <span class="k">for</span> <span class="n">level1designs</span>
</pre></div>
</div>
<span class="target" id="nipype-algorithms-modelgen-specifyspmmodel"></span></div>
</div>
<div class="section" id="specifyspmmodel">
<span id="index-1"></span><h2>SpecifySPMModel<a class="headerlink" href="#specifyspmmodel" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L473">Link to code</a></p>
<p>Adds SPM specific options to SpecifyModel</p>
<blockquote>
<div><dl class="docutils">
<dt>adds:</dt>
<dd><ul class="first last simple">
<li>concatenate_runs</li>
<li>output_units</li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.algorithms</span> <span class="k">import</span> <span class="n">modelgen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.interfaces.base</span> <span class="k">import</span> <span class="n">Bunch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">modelgen</span><span class="o">.</span><span class="n">SpecifySPMModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">input_units</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">output_units</span> <span class="o">=</span> <span class="s1">&#39;scans&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">high_pass_filter_cutoff</span> <span class="o">=</span> <span class="mf">128.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">functional_runs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;functional2.nii&#39;</span><span class="p">,</span> <span class="s1">&#39;functional3.nii&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_repetition</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">concatenate_runs</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run2</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run3</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">subject_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">evs_run2</span><span class="p">,</span> <span class="n">evs_run3</span><span class="p">]</span>
</pre></div>
</div>
<p>Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Mandatory]
event_files: (a list of items which are a list of items which are an
         existing file name)
        List of event description files 1, 2 or 3 column format
        corresponding to onsets, durations and amplitudes
        mutually_exclusive: subject_info, event_files
functional_runs: (a list of items which are a list of items which are
         an existing file name or an existing file name)
        Data files for model. List of 4D files or list of list of 3D files
        per session
high_pass_filter_cutoff: (a float)
        High-pass filter cutoff in secs
input_units: (&#39;secs&#39; or &#39;scans&#39;)
        Units of event onsets and durations (secs or scans). Output units
        are always in secs
subject_info: (a list of items which are a Bunch or None)
        Bunch or List(Bunch) subject-specific condition information. see
        :ref:`SpecifyModel` or SpecifyModel.__doc__ for details
        mutually_exclusive: subject_info, event_files
time_repetition: (a float)
        Time between the start of one volume to the start of the next image
        volume.

[Optional]
concatenate_runs: (a boolean, nipype default value: False)
        Concatenate all runs to look like a single session.
outlier_files: (a list of items which are an existing file name)
        Files containing scan outlier indices that should be tossed
output_units: (&#39;secs&#39; or &#39;scans&#39;, nipype default value: secs)
        Units of design event onsets and durations (secs or scans)
parameter_source: (&#39;SPM&#39; or &#39;FSL&#39; or &#39;AFNI&#39; or &#39;FSFAST&#39; or &#39;NIPY&#39;,
         nipype default value: SPM)
        Source of motion parameters
realignment_parameters: (a list of items which are an existing file
         name)
        Realignment parameters returned by motion correction algorithm
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session_info</span><span class="p">:</span> <span class="p">(</span><span class="nb">any</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">Session</span> <span class="n">info</span> <span class="k">for</span> <span class="n">level1designs</span>
</pre></div>
</div>
<span class="target" id="nipype-algorithms-modelgen-specifysparsemodel"></span></div>
</div>
<div class="section" id="specifysparsemodel">
<span id="index-2"></span><h2>SpecifySparseModel<a class="headerlink" href="#specifysparsemodel" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L656">Link to code</a></p>
<p>Specify a sparse model that is compatible with spm/fsl designers</p>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Perrachione TK and Ghosh SS (2013) Optimized design and analysis of</td></tr>
</tbody>
</table>
<p>sparse-sampling fMRI experiments. Front. Neurosci. 7:55
<a class="reference external" href="http://journal.frontiersin.org/Journal/10.3389/fnins.2013.00055/abstract">http://journal.frontiersin.org/Journal/10.3389/fnins.2013.00055/abstract</a></p>
</div>
<div class="section" id="id3">
<h3>Examples<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.algorithms</span> <span class="k">import</span> <span class="n">modelgen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nipype.interfaces.base</span> <span class="k">import</span> <span class="n">Bunch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">modelgen</span><span class="o">.</span><span class="n">SpecifySparseModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">input_units</span> <span class="o">=</span> <span class="s1">&#39;secs&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">functional_runs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;functional2.nii&#39;</span><span class="p">,</span> <span class="s1">&#39;functional3.nii&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_repetition</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">time_acquisition</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">high_pass_filter_cutoff</span> <span class="o">=</span> <span class="mf">128.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">model_hrf</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run2</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evs_run3</span> <span class="o">=</span> <span class="n">Bunch</span><span class="p">(</span><span class="n">conditions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond1&#39;</span><span class="p">],</span> <span class="n">onsets</span><span class="o">=</span><span class="p">[[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]],</span> <span class="n">durations</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">subject_info</span> <span class="o">=</span> <span class="p">[</span><span class="n">evs_run2</span><span class="p">,</span> <span class="n">evs_run3</span><span class="p">]</span>
</pre></div>
</div>
<p>Inputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Mandatory]
event_files: (a list of items which are a list of items which are an
         existing file name)
        List of event description files 1, 2 or 3 column format
        corresponding to onsets, durations and amplitudes
        mutually_exclusive: subject_info, event_files
functional_runs: (a list of items which are a list of items which are
         an existing file name or an existing file name)
        Data files for model. List of 4D files or list of list of 3D files
        per session
high_pass_filter_cutoff: (a float)
        High-pass filter cutoff in secs
input_units: (&#39;secs&#39; or &#39;scans&#39;)
        Units of event onsets and durations (secs or scans). Output units
        are always in secs
subject_info: (a list of items which are a Bunch or None)
        Bunch or List(Bunch) subject-specific condition information. see
        :ref:`SpecifyModel` or SpecifyModel.__doc__ for details
        mutually_exclusive: subject_info, event_files
time_acquisition: (a float)
        Time in seconds to acquire a single image volume
time_repetition: (a float)
        Time between the start of one volume to the start of the next image
        volume.

[Optional]
model_hrf: (a boolean)
        Model sparse events with hrf
outlier_files: (a list of items which are an existing file name)
        Files containing scan outlier indices that should be tossed
parameter_source: (&#39;SPM&#39; or &#39;FSL&#39; or &#39;AFNI&#39; or &#39;FSFAST&#39; or &#39;NIPY&#39;,
         nipype default value: SPM)
        Source of motion parameters
realignment_parameters: (a list of items which are an existing file
         name)
        Realignment parameters returned by motion correction algorithm
save_plot: (a boolean)
        Save plot of sparse design calculation (requires matplotlib)
scale_regressors: (a boolean, nipype default value: True)
        Scale regressors by the peak
scan_onset: (a float, nipype default value: 0.0)
        Start of scanning relative to onset of run in secs
stimuli_as_impulses: (a boolean, nipype default value: True)
        Treat each stimulus to be impulse-like
use_temporal_deriv: (a boolean)
        Create a temporal derivative in addition to regular regressor
        requires: model_hrf
volumes_in_cluster: (a long integer &gt;= 1, nipype default value: 1)
        Number of scan volumes in a cluster
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">session_info</span><span class="p">:</span> <span class="p">(</span><span class="nb">any</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">Session</span> <span class="n">info</span> <span class="k">for</span> <span class="n">level1designs</span>
<span class="n">sparse_png_file</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span> <span class="n">file</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">PNG</span> <span class="n">file</span> <span class="n">showing</span> <span class="n">sparse</span> <span class="n">design</span>
<span class="n">sparse_svg_file</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span> <span class="n">file</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">SVG</span> <span class="n">file</span> <span class="n">showing</span> <span class="n">sparse</span> <span class="n">design</span>
</pre></div>
</div>
<span class="target" id="module-nipype.algorithms.modelgen"></span></div>
</div>
<div class="section" id="gcd">
<span id="nipype-algorithms-modelgen-gcd"></span><h2><code class="xref py py-func docutils literal notranslate"><span class="pre">gcd()</span></code><a class="headerlink" href="#gcd" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L35">Link to code</a></p>
<p>Returns the greatest common divisor of two integers</p>
<p>uses Euclid’s algorithm</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">~</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">~</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gcd</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">55</span><span class="p">)</span>
<span class="go">~~</span>
</pre></div>
</div>
</div>
<div class="section" id="gen-info">
<span id="nipype-algorithms-modelgen-gen-info"></span><h2><code class="xref py py-func docutils literal notranslate"><span class="pre">gen_info()</span></code><a class="headerlink" href="#gen-info" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L148">Link to code</a></p>
<p>Generate subject_info structure from a list of event files</p>
</div>
<div class="section" id="orth">
<span id="nipype-algorithms-modelgen-orth"></span><h2><code class="xref py py-func docutils literal notranslate"><span class="pre">orth()</span></code><a class="headerlink" href="#orth" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L104">Link to code</a></p>
<p>Orthogonalize y_in with respect to x_in.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orth_expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.7142857142857144</span><span class="p">,</span> <span class="mf">0.42857142857142883</span><span class="p">,</span>                                   <span class="o">-</span><span class="mf">0.85714285714285676</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">orth</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">-</span> <span class="n">orth_expected</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="scale-timings">
<span id="nipype-algorithms-modelgen-scale-timings"></span><h2><code class="xref py py-func docutils literal notranslate"><span class="pre">scale_timings()</span></code><a class="headerlink" href="#scale-timings" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L124">Link to code</a></p>
<p>Scales timings given input and output units (scans/secs)</p>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>timelist: list of times to scale
input_units: ‘secs’ or ‘scans’
output_units: Ibid.
time_repetition: float in seconds</p>
</div>
</div>
<div class="section" id="spm-hrf">
<span id="nipype-algorithms-modelgen-spm-hrf"></span><h2><code class="xref py py-func docutils literal notranslate"><span class="pre">spm_hrf()</span></code><a class="headerlink" href="#spm-hrf" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://github.com/nipy/nipype/tree/93c475b/nipype/algorithms/modelgen.py#L53">Link to code</a></p>
<p>python implementation of spm_hrf</p>
<p>see spm_hrf for implementation details</p>
<p>% RT   - scan repeat time
% p    - parameters of the response function (two gamma
% functions)
% defaults  (seconds)
%   p(0) - delay of response (relative to onset)       6
%   p(1) - delay of undershoot (relative to onset)    16
%   p(2) - dispersion of response                      1
%   p(3) - dispersion of undershoot                    1
%   p(4) - ratio of response to undershoot             6
%   p(5) - onset (seconds)                             0
%   p(6) - length of kernel (seconds)                 32
~
% hrf  - hemodynamic response function
% p    - parameters of the response function</p>
<p>the following code using scipy.stats.distributions.gamma
doesn’t return the same result as the spm_Gpdf function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hrf</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">dt</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span>
      <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">dt</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">spm_hrf</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[  0.00000000e+00   8.65660810e-02   3.74888236e-01   3.84923382e-01</span>
<span class="go">   2.16117316e-01   7.68695653e-02   1.62017720e-03  -3.06078117e-02</span>
<span class="go">  -3.73060781e-02  -3.08373716e-02  -2.05161334e-02  -1.16441637e-02</span>
<span class="go">  -5.82063147e-03  -2.61854250e-03  -1.07732374e-03  -4.10443522e-04</span>
<span class="go">  -1.46257507e-04]</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-18, Neuroimaging in Python team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
</div>

  </body>
</html>